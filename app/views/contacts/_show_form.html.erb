<div class="container-fluid">
<div class="row">
<div class="col-md-8">
<div class="card card-5" >
<%= form_with model: @contact,  :format=> :js, multipart: true, :authenticity_token => true, id: "contact_form"  do |form|%>
<div class="card-header card-header-icon ">
   <div class="card-icon bg-hudson ">
      <i class="material-icons">perm_identity</i>
   </div>
   <h4 class="card-title text-light text-left">Contact / Facts
      <button class="btn btn-success pull-right" type="button" data-toggle="collapse" data-target="#form-collapse" aria-expanded="false" aria-controls="form-collapse">
      Edit Contact
      </button>

   </h4>
</div>
<div class="card-body">
   <div class="card-body">
      <div class="collapse" id="form-collapse">
         <%= form_with model: @contact,  :format=> :js, multipart: true, remote: local_assigns[:ajax_true], :authenticity_token => true, id: "contact_form"  do |form|%>
         <%= render 'layouts/messages' if !flash.empty? %>
         <!--      Wizard container        -->
         <div class="wizard-container">
            <div class="card card-wizard card-6" data-color="green" id="wizardProfile" >
               <!--        You can switch " data-color="primary" "  with one of the next bright colors: "green", "orange", "red", "blue"       -->
               <div class="card-header text-center">
                  <button type="button" class="close text-white" data-dismiss="modal" aria-label="Close" id="close-form">
                  <span aria-hidden="true">&times;</span>
                  </button>
                  <h3 class="card-title text-white">
                     Build The Contact Profile
                  </h3>
                  <h5 class="card-description text-white">This information will store what we need for the contact or customer.</h5>
               </div>
               <div class="wizard-navigation" >
                  <ul class="nav nav-pills text-light">
                     <li class="nav-item col-md-3" text-light>
                        <a class="nav-link active text-light" href="#about" id="about_id" data-toggle="tab" role="tab" style="color: white !important">
                        Account
                        </a>
                     </li>
                     <li class="nav-item col-md-3 text-light">
                        <a class="nav-link  text-light" href="#account"  id="account_id" data-toggle="tab" role="tab" style="color: white !important">
                        More
                        </a>
                     </li>
                     <li class="nav-item col-md-3 text-light" >
                        <a class="nav-link  text-light" href="#address" id="address_id" data-toggle="tab" role="tab" style="color: white !important">
                        Address
                        </a>
                     </li>
                     <li class="nav-item col-md-3 text-light" >
                        <a class="nav-link  text-light" href="#group" id="link_group_id" data-toggle="tab" role="tab" style="color: white !important">
                        Group
                        </a>
                     </li>
                  </ul>
               </div>
               <div class="card-body">
                  <div class="tab-content">
                     <div class="tab-pane active" id="about">
                        <div class="row">
                           <div class="col-sm-4">
                           </div>
                           <div class="form-group col-sm-6 ml-4 pl-4">
                              <div class="input-group form-control-lg ml-4">
                                 <div class="input-group-prepend ">
                                    <span class="input-group-text">
                                    <i class="material-icons text-white">phone</i>
                                    </span>
                                 </div>
                                 <div class="form-group text-white">
                                    <label for="exampleInput1" class="bmd-label-floating text-white">Contact Phone</label>
                                    <%= form.text_field :phone, id: :contact_phone, class: 'form-control text-white' %>
                                 </div>
                              </div>
                           </div>
                        </div>
                        <div class="row justify-content-center">
                           <div class="col-sm-4">
                              <div class="fileinput fileinput-new" data-provides="fileinput">
                                 <div class="fileinput-new thumbnail" style="max-width: 150px; max-height: 150px;"><%= image_tag @contact.avatar.present? ? @contact.avatar.url(:thumb) : 'http://placehold.it/150x150', class: "media-object" %>
                                 </div>
                                 <div class="fileinput-preview fileinput-exists thumbnail" style="max-width: 200px; max-height: 150px;"><%= image_tag @contact.avatar.present? ? @contact.avatar.url(:thumb) : 'http://placehold.it/150x150', class: "media-object" %>
                                 </div>
                                 <div class="text-center">
                                    <span class="btn btn-default btn-file">
                                    <span class="fileinput-new text-white">Choose Photo</span>
                                    <span class="fileinput-exists text-white">Change</span><%= form.file_field :avatar %>
                                    </span>
                                    <a href="#" class="btn btn-default fileinput-exists" data-dismiss="fileinput">Remove</a>
                                 </div>
                              </div>
                           </div>
                           <div class="col-sm-6">
                              <div class="input-group form-control-lg text-white">
                                 <div class="input-group-prepend">
                                    <span class="input-group-text">
                                    <i class="material-icons text-white">face</i>
                                    </span>
                                 </div>
                                 <div class="form-group">
                                    <label for="exampleInput1" class="bmd-label-floating text-white">Contact Name (required)</label>
                                    <%= form.text_field :name, id: :contact_name, class: 'form-control text-white', required: true %>
                                 </div>
                              </div>
                              <div class="input-group form-control-lg text-white">
                                 <div class="input-group-prepend">
                                    <span class="input-group-text">
                                    <i class="material-icons text-white" text-white>record_voice_over</i>
                                    </span>
                                 </div>
                                 <div class="form-group text-white">
                                    <label for="exampleInput11" class="bmd-label-floating text-white">Company Name</label>
                                    <%= form.text_field :company, id: :contact_company, class: 'form-control text-white'%>
                                 </div>
                              </div>
                           </div>
                           <div class="col-lg-10 mt-3 ml-0 pl-0 text-white">
                              <div class="input-group form-control-lg ml-0 pl-0">
                                 <div class="input-group-prepend ml-0 pl-0">
                                    <span class="input-group-text ml-0 pl-0">
                                    <i class="material-icons text-white">email</i>
                                    </span>
                                 </div>
                                 <div class="form-group pl-0">
                                    <label for="exampleInput1" class="bmd-label-floating text-white">Email</label>
                                    <%= form.email_field :email, id: :contact_email, class: 'form-control text-white' %>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="tab-pane" id="account">
                        <div class="controls">
                           <div class="row mb-3">
                              <div class="col-md-3">
                                 <%= form.label :prefix, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :prefix, id: :contacts_prefix, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :first_name, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :first_name, id: :contacts_first_name, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :middle_name, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :middle_name, id: :contacts_suffix, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :last_name, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :last_name, id: :contacts_last_name, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="row mb-3">
                           </div>
                           <div class="row mb-3">
                              <div class="col-md-3">
                                 <%= form.label :suffix, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :suffix, id: :contacts_suffix, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <label class="bmd-label-floating text-white">Owns or Rents</label>
                                 <%= form.text_field :owns_cents, id: :contactnews_owns_cents, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :year_of_Founding, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :year_of_Founding, id: :contactnews_year_of_Founding, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :primary_industry, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :primary_industry, id: :contacts_primary_industry, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="row mb-3">
                              <div class="col-md-3">
                                 <%= form.label :web_address, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :web_address, id: :contacts_web_address, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :latitude, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :latitude, id: :contacts_latitude, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3 ">
                                 <%= form.label :longitude, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :longitude, id: :contacts_longitude, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <%= form.label :type, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :type, id: :contacts_type, class: 'form-control' %>
                              </div>
                           </div>
                           <div class="row mb-3">
                              <div class="col-md-3">
                                 <%= form.label :facility_size, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :facility_size, id: :contactnews_facility_size, class: 'form-control' %>
                              </div>
                              <div class="col-md-4 ">
                                 <%= form.label :total_number_of_employees, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :total_number_of_employees, id: :contactnews_total_number_of_employees, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-3">
                                 <LABEL class= "bmd-label-floating text-white">position</LABEL>
                                 <%= form.text_field :postion, id: :contacts_postion, class: 'form-control text-white' %>
                              </div>
                              <div class="col-md-2">
                                 <%= form.label :sic, class: 'bmd-label-floating text-white' %>
                                 <%= form.text_field :sic, id: :contacts_sic, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="row mt-4">
                              <div class="col-md-12 pt-4">
                                 <p class="text-muted mt-3"><strong>*</strong> These fields are the extras we added not required.  </p>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="tab-pane" id="address">
                        <div class="row justify-content-center">
                           <div class="col-sm-12">
                              <h5 class="info-text text-white">Fill out the current address for contact </h5>
                              <input type="hidden" name="contact[address]" id="c-add-hidden">
                           </div>
                           <div class="col-sm-7">
                              <div class="form-group text-white">
                                 <label class="bmd-label-floating">Street Name</label>
                                 <%= form.text_field :strret_name, id: :contact_strret_name, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="col-sm-3">
                              <div class="form-group text-white">
                                 <label class="bmd-label-floating">Street No.</label>
                                 <%= form.text_field :street_num, id: :contact_street_num, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="col-sm-5">
                              <div class="form-group text-white">
                                 <label class="bmd-label-floating">City</label>
                                 <%= form.text_field :city, id: :contact_city, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="col-sm-5">
                              <div class="form-group">
                                 <select class="selectpicker county-select " name="contact[county]" data-style="select-with-transition" title="Single Select">
                                    <option value="Select County"> Select County </option>
                                    <option value="Dutchess"> Dutchess </option>
                                    <option value="Ulster"> Ulster </option>
                                    <option value="Putnam"> Putnam </option>
                                    <option value="Orange"> Orange </option>
                                    <option value="Columbia"> Columbia </option>
                                    <option value="Sullivan"> Sullivan </option>
                                    <option value="Greene"> Greene </option>
                                    <option value="westchester"> westchester </option>
                                    <option value="westchester"> Rockland </option>
                                 </select>
                              </div>
                           </div>
                        </div>
                        <div class="row pl-4 pr-4 ml-4">
                           <div class="col-md-4">
                              <div class="form-group text-white">
                                 <label class="bmd-label-floating">State</label>
                                 <%= form.text_field :state, id: :contact_state, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group text-white">
                                 <label class="bmd-label-floating">Country</label>
                                 <%= form.text_field :country, id: :contact_country, class: 'form-control text-white' %>
                              </div>
                           </div>
                           <div class="col-md-4">
                              <div class="form-group text-white">
                                 <label class="bmd-label-floating">Postal Code</label>
                                 <%= form.text_field :postal_code, id: :contact_postal_code, class: 'form-control text-white' %>
                              </div>
                           </div>
                        </div>
                        <div class="row  pl-4 pr-4 ml-4">
                           <div class="col-md-12">
                              <div class="form-group text-white">
                                 <label>Contact Notes</label>
                                 <div class="form-group">
                                    <label class="bmd-label-floating">Enter important notes for this contact.</label>
                                    <%= form.text_area :notes, id: :contact_notes, class: 'form-control text-white' %>
                                 </div>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="tab-pane" id="account">
                        <h5 class="info-text text-white"> Pick users inculding yourself if needed (checkboxes) </h5>
                        <div class="controls">
                           <div class="row">
                              <div class="col-md-6">
                                 <div class="form-group">
                                    <label for="form_name">Firstname *</label>
                                    <input id="form_name" type="text" name="name" class="form-control" placeholder="Please enter your firstname *" required="required" data-error="Firstname is required.">
                                    <div class="help-block with-errors"></div>
                                 </div>
                              </div>
                              <div class="col-md-6">
                                 <div class="form-group">
                                    <label for="form_lastname">Lastname *</label>
                                    <input id="form_lastname" type="text" name="surname" class="form-control" placeholder="Please enter your lastname *" required="required" data-error="Lastname is required.">
                                    <div class="help-block with-errors"></div>
                                 </div>
                              </div>
                           </div>
                           <div class="row">
                              <div class="col-md-6">
                                 <div class="form-group">
                                    <label for="form_email">Email *</label>
                                    <input id="form_email" type="email" name="email" class="form-control" placeholder="Please enter your email *" required="required" data-error="Valid email is required.">
                                    <div class="help-block with-errors"></div>
                                 </div>
                              </div>
                              <div class="col-md-6">
                                 <div class="form-group">
                                    <label for="form_phone">Phone</label>
                                    <input id="form_phone" type="tel" name="phone" class="form-control" placeholder="Please enter your phone">
                                    <div class="help-block with-errors"></div>
                                 </div>
                              </div>
                           </div>
                           <div class="row">
                              <div class="col-md-12">
                                 <div class="form-group">
                                    <label for="form_message">Message *</label>
                                    <textarea id="form_message" name="message" class="form-control" placeholder="Message for me *" rows="4" required="required" data-error="Please,leave us a message."></textarea>
                                    <div class="help-block with-errors"></div>
                                 </div>
                              </div>
                              <div class="col-md-12">
                                 <input type="submit" class="btn btn-success btn-send" value="Send message">
                              </div>
                           </div>
                           <div class="row">
                              <div class="col-md-12">
                                 <p class="text-muted"><strong>*</strong> These fields are required. Contact form template by <a href="http://bootstrapious.com" target="_blank">Bootstrapious</a>.</p>
                              </div>
                           </div>
                        </div>
                     </div>
                     <div class="tab-pane" id="group">
                        <div class="row justify-content-center">
                           <div class="col-sm-12">
                              <h5 class="info-text text-white">Very important to select group and the Emplyees who need access to the contact</h5>
                           </div>
                        </div>
                           <div class="col-md-12 ml-3 mr-0 pr-0 pl-0">
                              <div class="form-inline ">
                                 <div class="form-group ml-2 mr-0 pr-0 pl-0">
                                    <a class="btn btn-round btn-outline-info  ml-0 mr-0" data-toggle="collapse" href="#collapseGroup" aria-expanded="false" aria-controls="collapseGroup" id="round-group-btn">
                                    <i class="material-icons">group</i>
                                    Select Groups
                                    </a>
                                 </div>
                                 <div class="form-group ml-2 mr-0 pr-0 pl-0">
                                    <button class="btn  btn-outline-info  btn-round  ml-2 mr-0" type="button" data-toggle="collapse" data-target="#pickUsers" aria-expanded="false" aria-controls="pickUsers" id="round-user-btn">
                                    <i class="material-icons">person_add</i>
                                    Select Users
                                    </button>
                                 </div>
                                 <div class="form-group ml-2 mr-0 pr-0 pl-0">
                                    <a  class="btn btn-outline-info btn-round  ml-2 mr-0"  data-toggle="collapse" href="#add-users-group" aria-expanded="false" aria-controls="add-users-group">
                                    <i class="material-icons">group_add</i>
                                    Create Group
                                    </a>
                                 </div>
                              </div>
                           </div>
                           <p class="mt-3"> Pick One Best describes the contact role or leave blank</p>
                           <div class="form-group">
                              <div class="form-check form-check-inline">
                                 <label class="bmd-label-floating mr-2 pt-2">Broker:</label>
                                 <%= form.check_box :role, {:class => "employee mr-1", }, "broker", "potential_customer" %> |
                              </div>
                              <label class="bmd-label-floating mr-1 ml-2 pt-2">Agent:</label>
                              <div class="form-check form-check-inline">
                                 <%= form.check_box :role, {:class => "employee  mr-1", }, "agent", "potential_customer" %> |
                              </div>
                              <div class="form-check form-check-inline">
                                 <label class="bmd-label-floating mr-1 ml-2  pt-2" >Owner:</label>
                                 <%= form.check_box :role, {:class => "employee  mr-1", }, "owner", "potential_customer" %> |
                              </div>
                              <div class="form-check form-check-inline">
                                 <label class="bmd-label-floating mr-1 ml-2  pt-2">Buyer:</label>
                                 <%= form.check_box :role, {:class => "employee  mr-1", }, "buyer", "potential_customer" %> |
                              </div>
                              <div class="form-check form-check-inline">
                                 <label class="bmd-label-floating mr-1 ml-2  pt-2">Employee:</label>
                                 <%= form.check_box :role, {:class => "employee  mr-1", }, "employee", "potential_customer" %> |
                              </div>
                              <div class="form-check form-check-inline">
                                 <label class="bmd-label-floating mr-1 ml-2  pt-2">Management:</label>
                                 <%= form.check_box :role, {:class => "employee  mr-1", }, "management", "potential_customer" %> |
                              </div>
                              <div class="form-check form-check-inline">
                                 <label class="bmd-label-floating mr-1   ml-2  pt-2">Peronal:</label>
                                 <%= form.check_box :role, {:class => "employee  mr-1", }, "peronal", "potential_customer" %>
                              </div>
                           </div>
                           <div class="col-md-5 ml-0 pl-0 ">
                              <div class="row">
                                 <div class="form-group  collapse" id="add-users-group">
                                    <div class="row mt-4">
                                       <div class=" col-md-12">
                                          <div class="input-group pl-0">
                                             <div class="col-xl-12">
                                                <div class="row pl-0">
                                                   <div class="col-xl-10 pl-3 mb-4">
                                                      <label for="address" class="bmd-label-floating">New Group Name</label>
                                                      <input type="text" name="new_group" id="new_group" class="form-control ml-0 new_group text-white">
                                                   </div>
                                                   <div class="col-xl-2 ">
                                                      <span class="input-group-btn mr-0 ml-2">
                                                      <button type="button" class="btn btn-fab btn-round btn-info save-new-group" id="save-new-group" data-remote="true">
                                                      <i class="material-icons">input</i>
                                                      </button>
                                                      </span>
                                                   </div>
                                                </div>
                                             </div>
                                          </div>
                                       </div>
                                    </div>
                                    <div>
                                       <div class="btn-group">
                                          <% User.all.each do |user| %><%  next if !user.first_name  %>
                                          <div class="togglebutton form-check-inline">
                                             <label>
                                             <input type="checkbox" checked="true" value=
                                                <%="#{user.id}" if user.first_name %> class="users-for-new-group"/>
                                             <span class="toggle"></span>
                                             <span class="text-muted"><%= user.first_name if user.first_name %>
                                             </span>
                                             </label>
                                          </div>
                                          <% end %>
                                       </div>
                                    </div>
                                 </div>
                              </div>
                              <div class="form-group ml-0 pr-2 pl-0 mt-0">
                                 <div class=" mr-0 pl-3">
                                    <% attr = {prompt: "Select Groups"} %><% attr[:selected] = session[:selected_group_id].to_i if session[:selected_group_id] %>
                                    <div class="collapse " id="collapseGroup">
                                       <label for="cell" class="bmd-label-floating text-light ">Pick Groups<small>(required)</small></label><%= form.collection_select :group_id, @groups, :id, :name, attr,{remote: true, multiple: "true", required: true, class: "selectpicker select_g_picker", id: 'contact_group_id' } %>
                                    </div>
                                 </div>
                                 <div class="form-group  pl-3">
                                    <div class="collapse " id="pickUsers"><% attr = {prompt: "Select related users"} %><%  attr[:selected] = current_user.id %>
                                       <label for="cell" class="bmd-label-floating text-light" >Pick users<small>(required)</small></label><%= form.collection_select :user_id, User.all, :id, :first_name, attr,{ remote: true, multiple: "true", required: true,  class: "selectpicker select_u_picker"} %>
                                    </div>
                                 </div>
                              </div>
                           </div>
                           <div class="col-md-5">
                           </div>
                        </div>
                     </div>
                  </div>

               <div class="wizard-footer">
                  <div class="pull-right">
                     <input type="button" class="btn btn-next btn-fill btn-success btn-wd" name="next" value="Use tabs to navigate">
                     <button type="submit" class="btn btn-finish btn-fill btn-success btn-wd" name="finish" value="Finish" style="display: none;">Finish</button>
                  </div>
                  <div class="pull-left">
                     <input type="button" class="btn btn-previous btn-fill btn-default btn-wd disabled" name="previous" value="Previous">
                  </div>
                  <div class="clearfix"></div>
               </div>
            </div>
         </div>
      </div>
       </div>
         <!-- wizard container -->
         <% end %>
         <div class="form-check pull-right">
            <label class="form-check-label ">
               <%= form.check_box :verified, id: :contact_verified, class: 'form-check-input text-success ' %>
               <span class="form-check-sign text-success "  style="color:green">
               <span class="check text-success"></span>
               </span>
               <p class=" mb-3">  <%= @contact.verified ? 'Yes' : 'No' %>, Contact has beeen verified.</p>
            </label>
         </div>
         <div class="clearfix"></div>
      </div>



<% end %>
